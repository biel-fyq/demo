<view>
  <view>
    <view class="frost-tint"></view>
    <image src="https://yinyan-mini.cn-heyuan.oss.aliyuncs.com/20250924/logo_1758704246674.png" class="logo" style="padding-top:{{StatusBar}}px;"></image>
    <view class="container">
      <view class="main-content">
        <image class="watering-can-icon {{showWateringCan ? 'show' : ''}}" src="/img/12.png" mode="aspectFit">
        </image>
        <image class="flower-pot" src="{{flowerimgs[0]}}"></image>
        <view class="progress-container">
          <!-- 自定义进度条（贴图外观 + 可适配） -->
          <view class="process-box">
            <!-- 黄色填充在下层（轻微内缩），贴图作为上层边框 -->
            <view class="process-fill-bg" style="transform: scaleX({{progress/85}});"></view>
            <image src="/img/Vector 324.png" class="process-bag"></image>
            <!-- 拇指图标（跟随进度） -->
            <image src="/img/icon_smile.png" class="process-icon" style="left: calc(6% + (100% - 20%) * {{progress}} / 100);"></image>
          </view>
          <text class="progress-text">第0天</text>
        </view>
      </view>
      <!-- 右侧菜单 -->
      <view class="side-menu">
        <view class="menu-item" bindtap="showCalendar">
          <image class="menu-icon" src="/img/10.png"></image>
          <text style="font-family: 'ZCOOLKuaiLe',sans-serif;">养花日历</text>
        </view>
        <view class="menu-item" bindtap="waterPlant">
          <image class="menu-icon" src="/img/9.png"></image>
          <text>浇水</text>
        </view>
      </view>

      <!-- 弹框：带遮罩 -->
      <view wx:if="{{showPopup}}">
        <view class="popup-mask" bindtap="closePopup"></view>
        <view class="popup">
          <view class="popup-figure">
            <image class="popup-image" src="/img/15.png" mode="widthFix"></image>
            <view class="popup-header">每日打卡</view>
            <view class="popup-text-group">
              <text class="popup-title">浇水成功
                连续打开第一天</text>
              <button class="confirm-btn" bindtap="closePopup">确定</button>
            </view>
          </view>
        </view>
      </view>

      <!-- 日历弹框 -->
      <view wx:if="{{showCalendar}}">
        <view class="popup-mask" bindtap="hideCalendar"></view>
        <view class="calendar-popup">
          <view class="calendar-bg">
            <image class="calendar-bg-image" src="https://yinyan-mini.cn-heyuan.oss.aliyuncs.com/20250924/%E6%97%A5%E5%8E%86_1758713530166.png" mode="widthFix" />
          </view>
          <view class="calendar-content">
            <!-- <view class="calendar-header">{{calendarTitle}}</view> -->
            <view class="calendar-week">
              <block wx:for="{{weekTitles}}" wx:key="idx">
                <view class="calendar-week-item">{{item}}</view>
              </block>
            </view>
            <view class="calendar-grid">
              <block wx:for="{{calendarGrid}}" wx:key="index">
                <view class="calendar-cell {{item.type}}" data-index="{{index}}">
                  <view wx:if="{{item.type==='day'}}" class="calendar-day {{item.groupClass}} {{item.checked? 'checked' : ''}} {{item.isToday? 'today' : ''}}">
                    <text class="{{item.isToday ? 'calendar-nowday' : ''}}">{{item.isToday?'今':item.day}}</text>
                    <view wx:if="{{item.checked}}" class="calendar-tick">✓</view>
                  </view>
                </view>
              </block>
            </view>
            <view class="calendar-actions">
              <image src="/img/error.png" class="calendar-btn" bindtap="hideCalendar"></image>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>
</view>